const t=[];function n(n){const e=[];for(const o of t)n in o&&e.push(o);return e}window.ENTITES=t;const e={set(t,n,e){t.set(n,e)},get:(t,n,e)=>n in t?"function"==typeof t[n]?t[n].bind(t):t[n]:t.get(n),has:(t,n)=>n in t||t.has(n),deleteProperty:(t,n)=>t.delete(n)};class o extends Map{constructor(t){return super(Object.keys(t).reduce(((n,e)=>(n.push([e,t[e]]),n)),[])),new Proxy(this,e)}}function i(n){t.push(n)}function s(n){const e=t.indexOf(n);-1!==e&&t.splice(e,1)}const a={HOME:{background:"",entities:[new o({updateCard:{text:"Home"},position:{x:264,y:0},animations:[{duration:2.5,effect:"ease-in-out",to:{x:0,y:0}},{duration:1,effect:"ease-in-out",to:{x:0,y:-50}}]}),new o({player:!0,position:{x:24,y:28},mob:{bones:[{x:0,y:0,length:10,slope:[0,1]},{x:0,y:25,length:15,slope:[1,0]}]}})],paths:[]},TRAIN:{title:"Train",background:"",entities:[new o({player:!0,position:{x:10,y:10}})],paths:[]}};function r(n){t.length=0;for(let t of n.entities)i(t)}const c=document.getElementById("Card"),d={handleEvent(t){const{target:n}=t,{entity:e}=n;if(!e)return;const{animations:o=[]}=e;if(0===o.length)return;o[0].isPlaying&&(e.animations.splice(0,1),delete n.entity)}};c.addEventListener("transitionend",d);const l=new FontFace("jost","url(./fonts/Jost-700-Bold.ttf)");await l.load(),document.fonts.add(l),i(new o({"load-stage":"HOME"}));const u=[function*(t){for(;;){yield;const e=n("load-stage");if(e.length>0){const n=e[0],o=n["load-stage"];s(n),r(t[o])}}}(a),function*(){for(;;){yield;const t=n("animations");if(0!==t.length)for(let n of t){if(0===n.animations.length){delete n.animations;continue}const t=n.animations[0],{effect:e,duration:o,to:i,isPlaying:s=!1}=t;s||(t.isPlaying=!0,c.entity=n,c.style.transitionTimingFunction=e,c.style.transitionDuration=`${o}s`,c.style.transform=`translate(${i.x}px, ${i.y}px)`)}}}(),function*(){for(;;){yield;const t=n("updateCard");if(0===t.length)continue;const e=t[0],{text:o}=e.updateCard,{position:i}=e;c.querySelector("text").innerHTML=o,c.setAttribute("transform",`matrix(1, 0, 0, 1, ${i.x}, ${i.y})`),delete e.updateCard}}()];window.IS_RUNNING=!0;let f=0;!function t(){let n=Date.now(),e=(n-f)/1e3;u.forEach((t=>t.next({delta:e}))),f=n,window.IS_RUNNING&&window.requestAnimationFrame(t)}();
