<!doctype html><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content=yes name=apple-mobile-web-app-capable><meta content=$pay.stronghold.co/1a136a73a59d52b475b94e49fdea69dae89 name=monetization><title>JS13KGame 2019: Theme "Back"!</title><script src=https://aframe.io/releases/0.9.2/aframe.min.js></script><style>body,html{width:100%;height:100%;margin:0;padding:0}</style><script>(function(){'use strict';function a(a){const b=a=>10>a?"0"+a:""+a,c=b(0|a/1e3/60),d=b(0|a/1e3-60*c);return`${c}:${d}`}function b(){return m+=1,"uuid"+m}function c(){const a={toyboxes:[],toys:[],selectedToy:null,selectedToybox:null},b=[];for(let a,c=0;c<u;c++){for(a=t();b.includes(a);)a=t();b.push(a)}return a.toys=b.reduce((a,b)=>{const c=[,,,,].fill().map(()=>new n(b));return a.concat(c)},[]),["-2 0.1 -1","0 0.1 -1","2 0.1 -1"].forEach((c,d)=>{a.toyboxes[d]=new r({shape:b[d],totalToys:v,position:c})}),a}function d(a){return w.hasOwnProperty(a)?w[a]:0}function*e(a,b=!1){let c=0,d=!0;for(;d;)yield a[c],c+=1,c>=a.length&&(c=0,!b&&(d=!1))}const f=["TIMER"],g={PENCIL:["moveTo",[.333,.946],"lineTo",[.054,1],"lineTo",[0,.946],"lineTo",[.054,.667],"lineTo",[.721,0],"lineTo",[1,.277],"lineTo",[.333,.946]],BRUSH:["moveTo",[.901,0],"lineTo",[1,.098],"bezierCurveTo",[.678,.664,.427,.905,.248,.823],"lineTo",[.202,.774],"bezierCurveTo",[.139,.567,.372,.309,.901,0],"moveTo",[.097,.764],"lineTo",[.1,.761],"bezierCurveTo",[.119,.741,.141,.731,.168,.731],"bezierCurveTo",[.195,.73,.219,.74,.239,.76],"bezierCurveTo",[.258,.78,.267,.805,.267,.834],"bezierCurveTo",[.267,.863,.258,.887,.239,.907],"lineTo",[.236,.91],"bezierCurveTo",[.195,.953,.154,.983,.11,1],"lineTo",[.016,.997],"bezierCurveTo",[-.004,.977,-.005,.944,.012,.897],"bezierCurveTo",[.028,.851,.056,.807,.097,.764]],SOMETHING:["moveTo",[.857,.45],"bezierCurveTo",[.857,.464,.85,.476,.836,.486],"bezierCurveTo",[.821,.495,.805,.5,.786,.5],"lineTo",[.7,.5],"lineTo",[.691,.506],"bezierCurveTo",[.751,.524,.805,.549,.854,.581],"bezierCurveTo",[.951,.647,1,.727,1,.821],"bezierCurveTo",[1,.871,.951,.913,.854,.948],"bezierCurveTo",[.757,.983,.639,1,.5,1],"bezierCurveTo",[.362,1,.244,.983,.146,.948],"bezierCurveTo",[.05,.913,.001,.871,0,.821],"bezierCurveTo",[0,.727,.049,.647,.146,.581],"bezierCurveTo",[.195,.549,.249,.524,.309,.506],"lineTo",[.3,.5],"lineTo",[.214,.5],"bezierCurveTo",[.194,.5,.177,.495,.162,.486],"bezierCurveTo",[.149,.476,.143,.464,.143,.45],"lineTo",[.143,.051],"bezierCurveTo",[.143,.037,.149,.025,.162,.015],"bezierCurveTo",[.177,.005,.194,0,.214,0],"lineTo",[.786,0],"bezierCurveTo",[.805,0,.821,.005,.836,.015],"bezierCurveTo",[.85,.025,.857,.037,.857,.05],"lineTo",[.857,.45]],JOYSTICK:["moveTo",[.5,0],"bezierCurveTo",[.634,0,.749,.03,.843,.089],"bezierCurveTo",[.95,.155,1.002,.236,1,.334],"bezierCurveTo",[1.003,.43,.951,.511,.843,.577],"lineTo",[.845,.577],"bezierCurveTo",[.799,.606,.749,.628,.695,.643],"lineTo",[.695,.889],"bezierCurveTo",[.695,.92,.684,.947,.663,.969],"lineTo",[.66,.971],"bezierCurveTo",[.638,.99,.612,1,.584,1],"lineTo",[.417,1],"bezierCurveTo",[.386,1,.36,.99,.339,.971],"lineTo",[.336,.967],"bezierCurveTo",[.316,.945,.306,.919,.306,.889],"lineTo",[.306,.643],"bezierCurveTo",[.251,.628,.201,.606,.156,.577],"bezierCurveTo",[.05,.511,-.002,.43,0,.334],"bezierCurveTo",[-.002,.236,.05,.155,.156,.089],"bezierCurveTo",[.251,.03,.366,0,.5,0]],DPAD:["moveTo",[1,.333],"lineTo",[1,.667],"bezierCurveTo",[1,.681,.994,.694,.983,.706],"bezierCurveTo",[.972,.717,.959,.722,.944,.722],"lineTo",[.722,.722],"lineTo",[.722,.944],"bezierCurveTo",[.722,.96,.717,.974,.706,.985],"bezierCurveTo",[.694,.995,.681,1,.667,1],"lineTo",[.333,1],"bezierCurveTo",[.318,1,.304,.995,.293,.985],"bezierCurveTo",[.283,.974,.278,.96,.278,.944],"lineTo",[.278,.722],"lineTo",[.056,.722],"bezierCurveTo",[.04,.722,.026,.717,.015,.706],"bezierCurveTo",[.005,.694,0,.681,0,.667],"lineTo",[0,.333],"bezierCurveTo",[0,.318,.005,.304,.015,.293],"bezierCurveTo",[.026,.283,.04,.278,.056,.278],"lineTo",[.278,.278],"lineTo",[.278,.057],"bezierCurveTo",[.278,.041,.283,.028,.293,.017],"bezierCurveTo",[.304,.006,.318,0,.333,0],"lineTo",[.667,0],"bezierCurveTo",[.681,0,.694,.006,.706,.017],"bezierCurveTo",[.717,.028,.722,.041,.722,.056],"lineTo",[.722,.278],"lineTo",[.943,.278],"bezierCurveTo",[.959,.278,.972,.283,.983,.293],"bezierCurveTo",[.994,.304,1,.318,1,.333]],TURNARROW:["moveTo",[.29,.238],"bezierCurveTo",[.29,.405,.351,.547,.474,.665],"bezierCurveTo",[.532,.72,.596,.763,.667,.794],"bezierCurveTo",[.719,.815,.775,.829,.834,.835],"lineTo",[.834,.714],"lineTo",[1,.714],"lineTo",[1,1],"lineTo",[.917,.998],"bezierCurveTo",[.829,.998,.745,.986,.667,.962],"bezierCurveTo",[.551,.927,.447,.865,.356,.778],"bezierCurveTo",[.202,.63,.124,.45,.124,.238],"lineTo",[0,.238],"lineTo",[.207,0],"lineTo",[.414,.238],"lineTo",[.29,.238]],UARROW:["moveTo",[.769,.202],"lineTo",[.779,.208],"bezierCurveTo",[.926,.297,1,.407,1,.536],"bezierCurveTo",[1,.665,.926,.774,.779,.865],"bezierCurveTo",[.631,.954,.451,.999,.239,.999],"lineTo",[.159,1],"lineTo",[.159,.822],"lineTo",[.318,.822],"lineTo",[.318,.9],"bezierCurveTo",[.452,.89,.568,.855,.666,.796],"bezierCurveTo",[.783,.724,.841,.637,.841,.536],"bezierCurveTo",[.841,.434,.783,.348,.666,.277],"lineTo",[.656,.271],"lineTo",[.658,.271],"bezierCurveTo",[.541,.203,.402,.169,.239,.169],"lineTo",[.239,.242],"lineTo",[0,.121],"lineTo",[.239,0],"lineTo",[.239,.073],"bezierCurveTo",[.444,.073,.62,.115,.767,.201],"lineTo",[.767,.202],"lineTo",[.769,.202]],AWARD:["moveTo",[1,.352],"bezierCurveTo",[1,.449,.951,.532,.854,.601],"bezierCurveTo",[.81,.633,.761,.658,.708,.676],"lineTo",[.708,.973],"lineTo",[.698,.993],"lineTo",[.671,1],"lineTo",[.644,.994],"lineTo",[.5,.892],"lineTo",[.356,.994],"lineTo",[.329,1],"lineTo",[.302,.993],"lineTo",[.292,.973],"lineTo",[.292,.677],"bezierCurveTo",[.237,.659,.187,.633,.142,.601],"bezierCurveTo",[.047,.532,0,.449,0,.352],"bezierCurveTo",[0,.254,.047,.17,.142,.102],"bezierCurveTo",[.239,.034,.358,0,.5,0],"bezierCurveTo",[.639,0,.757,.034,.854,.102],"bezierCurveTo",[.951,.17,1,.254,1,.352]],AWARD2:["moveTo",[.902,.359],"bezierCurveTo",[.902,.439,.876,.51,.825,.572],"lineTo",[.827,.574],"lineTo",[.995,.838],"lineTo",[1,.857],"lineTo",[.983,.874],"lineTo",[.962,.878],"lineTo",[.805,.841],"lineTo",[.764,.982],"lineTo",[.747,.997],"lineTo",[.725,1],"lineTo",[.707,.988],"lineTo",[.539,.724],"lineTo",[.537,.719],"lineTo",[.502,.721],"lineTo",[.465,.719],"lineTo",[.462,.724],"lineTo",[.294,.988],"lineTo",[.275,1],"lineTo",[.254,.997],"lineTo",[.237,.982],"lineTo",[.195,.841],"lineTo",[.039,.878],"lineTo",[.017,.874],"lineTo",[0,.857],"bezierCurveTo",[-.001,.85,.001,.844,.005,.838],"lineTo",[.174,.574],"lineTo",[.177,.571],"bezierCurveTo",[.127,.51,.102,.439,.102,.359],"bezierCurveTo",[.102,.259,.14,.174,.215,.104],"bezierCurveTo",[.293,.035,.389,0,.502,0],"bezierCurveTo",[.613,0,.707,.035,.785,.104],"bezierCurveTo",[.863,.174,.902,.259,.902,.359]],TIMER:["moveTo",[.377,-.955],"quadraticCurveTo",[.5,-1.047,.623,-.955],"lineTo",[.911,-.739],"quadraticCurveTo",[1.034,-.648,.987,-.499],"lineTo",[.877,-.15],"quadraticCurveTo",[.83,-.001,.678,-.001],"lineTo",[.322,-.001],"quadraticCurveTo",[.17,-.001,.123,-.15],"lineTo",[.013,-.499],"quadraticCurveTo",[-.034,-.648,.089,-.739]],DIAMOND:["moveTo",[.98,.766],"bezierCurveTo",[.992,.754,.999,.737,1,.716],"bezierCurveTo",[1.001,.698,.996,.68,.986,.664],"lineTo",[.547,.024],"lineTo",[.518,0],"lineTo",[.483,0],"bezierCurveTo",[.471,.005,.462,.013,.454,.024],"lineTo",[.015,.664],"bezierCurveTo",[.004,.68,-.001,.698,0,.716],"bezierCurveTo",[.001,.735,.007,.751,.018,.764],"lineTo",[.194,.978],"bezierCurveTo",[.206,.993,.22,1,.236,1],"lineTo",[.75,1],"bezierCurveTo",[.766,1,.78,.993,.791,.98],"lineTo",[.98,.766]],CHECKMARK:["moveTo",[.234,.791],"bezierCurveTo",[.246,.79,.257,.784,.266,.774],"lineTo",[.423,.561],"lineTo",[.736,.981],"bezierCurveTo",[.743,.991,.753,.998,.765,1],"bezierCurveTo",[.778,1.001,.789,.997,.798,.988],"lineTo",[.984,.807],"bezierCurveTo",[.994,.799,.999,.788,1,.774],"bezierCurveTo",[1.001,.76,.998,.747,.991,.735],"lineTo",[.459,.016],"lineTo",[.437,0],"lineTo",[.412,0],"lineTo",[.388,.016],"lineTo",[.011,.526],"bezierCurveTo",[.003,.538,-.001,.55,0,.563],"bezierCurveTo",[.001,.579,.007,.59,.016,.599],"lineTo",[.201,.779],"bezierCurveTo",[.211,.789,.222,.793,.234,.791]],WRENCH:["moveTo",[.563,.093],"bezierCurveTo",[.62,.145,.653,.21,.663,.286],"lineTo",[.663,.289],"lineTo",[.663,.291],"lineTo",[.663,.336],"lineTo",[.66,.373],"lineTo",[.939,.651],"bezierCurveTo",[.975,.682,.995,.721,.999,.767],"lineTo",[1,.796],"bezierCurveTo",[1,.854,.981,.903,.941,.942],"lineTo",[.939,.943],"bezierCurveTo",[.903,.981,.854,1,.793,1],"bezierCurveTo",[.737,1,.689,.981,.647,.943],"lineTo",[.647,.942],"lineTo",[.461,.756],"lineTo",[.457,.744],"lineTo",[.364,.656],"lineTo",[.282,.651],"lineTo",[.285,.653],"bezierCurveTo",[.212,.641,.15,.611,.099,.561],"lineTo",[.099,.56],"bezierCurveTo",[.025,.482,-.007,.396,.002,.302],"bezierCurveTo",[.003,.271,.009,.241,.021,.211],"bezierCurveTo",[.023,.204,.026,.2,.032,.197],"lineTo",[.047,.193],"lineTo",[.06,.201],"lineTo",[.238,.381],"lineTo",[.272,.399],"lineTo",[.304,.382],"lineTo",[.304,.381],"lineTo",[.379,.302],"bezierCurveTo",[.394,.287,.398,.271,.391,.255],"lineTo",[.377,.233],"lineTo",[.199,.061],"lineTo",[.193,.049],"bezierCurveTo",[.19,.042,.191,.037,.194,.033],"bezierCurveTo",[.196,.028,.2,.024,.205,.022],"bezierCurveTo",[.219,.015,.232,.009,.244,.005],"lineTo",[.246,.005],"lineTo",[.394,0],"bezierCurveTo",[.459,.012,.515,.042,.564,.093],"lineTo",[.563,.093]],GEAR:["moveTo",[.963,.306],"bezierCurveTo",[.988,.366,1,.43,1,.5],"bezierCurveTo",[1,.51,.996,.519,.989,.527],"bezierCurveTo",[.982,.534,.973,.538,.963,.538],"lineTo",[.859,.538],"lineTo",[.847,.602],"lineTo",[.944,.642],"lineTo",[.964,.663],"bezierCurveTo",[.968,.672,.968,.681,.964,.691],"bezierCurveTo",[.94,.75,.903,.805,.853,.855],"lineTo",[.828,.864],"lineTo",[.802,.855],"lineTo",[.728,.781],"lineTo",[.673,.819],"lineTo",[.714,.914],"bezierCurveTo",[.718,.923,.718,.933,.714,.942],"lineTo",[.694,.963],"bezierCurveTo",[.634,.988,.57,1,.5,1],"bezierCurveTo",[.49,1,.481,.996,.473,.989],"bezierCurveTo",[.466,.982,.463,.973,.463,.963],"lineTo",[.463,.859],"lineTo",[.398,.848],"lineTo",[.359,.944],"lineTo",[.339,.964],"bezierCurveTo",[.33,.968,.32,.968,.311,.964],"bezierCurveTo",[.251,.94,.196,.904,.147,.855],"bezierCurveTo",[.14,.847,.136,.839,.136,.828],"bezierCurveTo",[.136,.818,.14,.809,.147,.802],"lineTo",[.22,.728],"lineTo",[.183,.673],"lineTo",[.086,.714],"bezierCurveTo",[.077,.718,.067,.718,.058,.714],"lineTo",[.038,.694],"bezierCurveTo",[.013,.634,0,.57,0,.5],"bezierCurveTo",[0,.49,.004,.481,.011,.473],"bezierCurveTo",[.018,.466,.027,.463,.038,.463],"lineTo",[.141,.463],"lineTo",[.153,.398],"lineTo",[.056,.359],"lineTo",[.036,.339],"bezierCurveTo",[.032,.33,.032,.32,.036,.311],"bezierCurveTo",[.06,.251,.097,.196,.147,.147],"bezierCurveTo",[.154,.14,.163,.136,.172,.136],"bezierCurveTo",[.182,.136,.191,.14,.198,.147],"lineTo",[.272,.22],"bezierCurveTo",[.29,.206,.308,.193,.327,.183],"lineTo",[.286,.086],"bezierCurveTo",[.282,.077,.282,.067,.286,.058],"bezierCurveTo",[.29,.048,.297,.042,.306,.038],"bezierCurveTo",[.366,.013,.43,0,.5,0],"bezierCurveTo",[.51,0,.519,.004,.527,.011],"bezierCurveTo",[.534,.018,.538,.027,.538,.038],"lineTo",[.538,.141],"lineTo",[.602,.153],"lineTo",[.642,.056],"bezierCurveTo",[.645,.047,.652,.04,.661,.036],"bezierCurveTo",[.67,.032,.68,.032,.691,.036],"bezierCurveTo",[.729,.052,.766,.073,.802,.1],"lineTo",[.853,.147],"bezierCurveTo",[.86,.154,.864,.163,.864,.173],"lineTo",[.853,.198],"lineTo",[.781,.272],"lineTo",[.817,.327],"lineTo",[.914,.286],"bezierCurveTo",[.923,.282,.933,.282,.942,.286],"lineTo",[.963,.306]],KEY:["moveTo",[.867,.098],"bezierCurveTo",[.868,.119,.865,.137,.857,.153],"lineTo",[.982,.296],"bezierCurveTo",[1.006,.324,1.006,.352,.982,.38],"lineTo",[.954,.411],"lineTo",[.941,.42],"lineTo",[.929,.413],"lineTo",[.91,.391],"lineTo",[.844,.47],"lineTo",[.863,.49],"lineTo",[.867,.503],"lineTo",[.861,.518],"lineTo",[.835,.55],"bezierCurveTo",[.809,.579,.784,.579,.76,.55],"lineTo",[.635,.406],"lineTo",[.516,.547],"bezierCurveTo",[.54,.592,.557,.641,.566,.693],"lineTo",[.563,.695],"bezierCurveTo",[.578,.791,.559,.867,.505,.924],"bezierCurveTo",[.455,.987,.387,1.011,.303,.995],"bezierCurveTo",[.236,.982,.175,.946,.12,.889],"lineTo",[.109,.875],"bezierCurveTo",[.051,.811,.016,.738,.004,.657],"lineTo",[.004,.655],"bezierCurveTo",[-.001,.624,-.001,.595,.003,.57],"bezierCurveTo",[.006,.51,.026,.46,.063,.42],"bezierCurveTo",[.099,.377,.143,.354,.194,.348],"lineTo",[.266,.351],"lineTo",[.27,.351],"bezierCurveTo",[.313,.36,.354,.379,.392,.406],"lineTo",[.727,.021],"bezierCurveTo",[.74,.004,.759,-.003,.783,.001],"bezierCurveTo",[.805,.004,.824,.015,.839,.034],"lineTo",[.852,.048],"bezierCurveTo",[.862,.062,.867,.079,.867,.098]],MUSICNOTE:["moveTo",[1,.906],"lineTo",[1,.419],"lineTo",[1,.408],"bezierCurveTo",[.993,.349,.968,.3,.926,.263],"lineTo",[.922,.263],"bezierCurveTo",[.878,.22,.825,.196,.765,.192],"lineTo",[.763,.192],"bezierCurveTo",[.7,.186,.647,.203,.606,.242],"bezierCurveTo",[.565,.276,.547,.322,.554,.38],"bezierCurveTo",[.56,.432,.584,.477,.628,.516],"bezierCurveTo",[.67,.553,.715,.574,.765,.58],"lineTo",[.815,.58],"lineTo",[.815,.742],"lineTo",[.444,.742],"lineTo",[.444,.193],"bezierCurveTo",[.447,.152,.422,.111,.368,.071],"lineTo",[.367,.066],"bezierCurveTo",[.322,.028,.271,.007,.213,.001],"lineTo",[.211,.001],"bezierCurveTo",[.147,-.004,.094,.011,.054,.048],"bezierCurveTo",[.012,.083,-.006,.129,.002,.184],"bezierCurveTo",[.007,.237,.031,.284,.074,.324],"lineTo",[.078,.326],"bezierCurveTo",[.118,.36,.163,.381,.211,.39],"lineTo",[.213,.39],"lineTo",[.296,.387],"lineTo",[.296,.903],"bezierCurveTo",[.294,.97,.324,1.002,.387,1],"lineTo",[.889,1],"bezierCurveTo",[.963,1,1,.969,1,.906]],LOCK:["moveTo",[.875,.895],"lineTo",[.875,.789],"lineTo",[.75,.789],"lineTo",[.75,.895],"lineTo",[.25,.895],"lineTo",[.25,.526],"lineTo",[1,.526],"lineTo",[1,.053],"bezierCurveTo",[1,.038,.994,.025,.981,.014],"bezierCurveTo",[.969,.005,.954,0,.938,0],"lineTo",[.063,0],"bezierCurveTo",[.045,0,.03,.005,.017,.014],"bezierCurveTo",[.006,.025,0,.038,0,.053],"lineTo",[0,.526],"lineTo",[.125,.526],"lineTo",[.125,.895],"bezierCurveTo",[.125,.924,.137,.948,.161,.968],"bezierCurveTo",[.186,.989,.216,1,.25,1],"lineTo",[.75,1],"bezierCurveTo",[.784,1,.814,.989,.838,.968],"bezierCurveTo",[.863,.947,.875,.923,.875,.895]],HEART:["moveTo",[.528,.903],"bezierCurveTo",[.58,.968,.644,1,.722,1],"bezierCurveTo",[.798,1,.864,.968,.919,.903],"lineTo",[.922,.903],"bezierCurveTo",[.974,.839,1,.764,1,.678],"bezierCurveTo",[1,.605,.982,.542,.944,.488],"lineTo",[.919,.453],"lineTo",[.539,.019],"lineTo",[.5,0],"bezierCurveTo",[.485,0,.472,.006,.461,.019],"lineTo",[.081,.453],"lineTo",[.056,.488],"bezierCurveTo",[.019,.542,0,.605,0,.678],"bezierCurveTo",[0,.764,.027,.839,.081,.903],"bezierCurveTo",[.136,.968,.202,1,.278,1],"bezierCurveTo",[.356,1,.42,.968,.472,.903],"lineTo",[.528,.903]],HOUSE:["moveTo",[.375,0],"lineTo",[.188,0],"bezierCurveTo",[.17,0,.155,.006,.142,.017],"bezierCurveTo",[.131,.03,.125,.045,.125,.062],"lineTo",[.125,.375],"lineTo",[0,.375],"lineTo",[0,.5],"lineTo",[.5,1],"lineTo",[1,.5],"lineTo",[1,.375],"lineTo",[.875,.375],"lineTo",[.875,.062],"bezierCurveTo",[.875,.045,.869,.03,.856,.017],"bezierCurveTo",[.844,.006,.829,0,.813,0],"lineTo",[.625,0],"lineTo",[.625,.375],"lineTo",[.375,.375],"lineTo",[.375,0]]};AFRAME.registerGeometry("extrudeShape",{schema:{icon:{default:"HEART"},extrudeDepth:{default:.15}},init(a){const b=g[a.icon];if(!b)throw new Error(`Unknown icon "${a.icon}". Did you mean "${a.icon.toUpperCase()}"?`);const c=new THREE.Shape;for(let d=0;d<b.length;d+=2){const a=b[d],e=b[d+1];c[a].apply(c,e)}const d={depth:a.extrudeDepth,bevelEnabled:!1},e=new THREE.ExtrudeGeometry(c,d);this.geometry=e}}),AFRAME.registerComponent("float-to",{schema:{targetPosition:{type:"vec3"},targetScale:{type:"vec3"},speed:{type:"number"},active:{default:!1},eventName:{default:"float-completed"}},init(){this.targetPosition=new THREE.Vector3,this.totalDistance=0},update(){this.targetPosition.copy(this.data.targetPosition),this.totalDistance=this.el.object3D.position.distanceToSquared(this.data.targetPosition)},tick(){if(!this.data.active)return;const{speed:a,targetScale:b}=this.data,{targetPosition:c,totalDistance:d}=this,e=this.el.object3D.position.distanceToSquared(c);this.el.object3D.lookAt(c),this.el.object3D.translateZ(a),this.el.object3D.scale.lerp(b,(d-e)/d),e<=a&&(this.el.setAttribute("float-to","active",!1),this.el.emit(this.data.eventName,{el:this.el}))}}),AFRAME.registerComponent("orbit",{schema:{startTheta:{default:0},deltaTheta:{type:"number"},radius:{type:"number"},active:{default:!0},center:{type:"vec3"}},init(){this.theta=this.data.startTheta,this.cameraPosition=document.querySelector("#camera").getAttribute("position")},tick(){if(!this.data.active)return;const{center:a,deltaTheta:b,radius:c}=this.data,{position:d}=this.el.object3D,{theta:e,cameraPosition:f}=this,g=a.x+c*Math.cos(e),h=a.y+c*Math.sin(e);this.el.object3D.lookAt(f),this.theta+=b,d.set(g,d.y,h)}}),AFRAME.registerComponent("selectable",{schema:{active:{default:!0},isSelected:{default:!1},type:{default:"Toy"}},init:function(){this.system=this.el.sceneEl.systems.game,this.lastIndex=-1,["click","triggerdown"].forEach(a=>{this.el.addEventListener(a,this)})},update(){this.data.isSelected?(this.el.emit("selected"),this.el.setAttribute("material","color","#0074D9")):(this.el.emit("unselected"),this.el.setAttribute("material","color","#DDDDDD"))},handleEvent(){this.data.active&&(this.system.setSelected(this.el),this.el.setAttribute("selectable","isSelected",!0))}});const h={MOVE_TO_TOYBOX:[["G#6",.5],["G6",.25],["F#6",.25],["F6",.5]],MOVE_TO_ORBIT:[["F6",.5],["F#6",.25],["G6",.25],["G#6",.5]],TIMER_TICK:[["Eb3"]]},i=[["C5",.5],["D5",.5],["C5",.5],["",1],["D5",.75],["E5",.5],["D5",.25],["E5",.25],["D5",.75],["C5",.5],["D5",.5],["C5",.5],["",1]],j=[["C4",.6],["C3",1.2],["C4",.6],["G4",.5999999999999999],["E3",1.2],["G4",.6000000000000001],["A4",.6000000000000001],["F3",1.1999999999999997],["A4",.5999999999999996],["G4",1.2000000000000002],["E3",1.2000000000000002],["F4",.5999999999999996],["D3",1.2000000000000002],["F4",.6000000000000005],["E4",.5999999999999996],["C3",1.1999999999999993],["E4",.5999999999999996],["D4",.6000000000000005],["F3",.6000000000000005],["D4",.6000000000000005],["G3",.6000000000000005],["C4",1.1999999999999993],["E3",.5999999999999996],["C3",.5999999999999996],["G4",.5999999999999996],["E3",1.1999999999999993],["G4",.5999999999999996],["F4",.6000000000000014],["F3",1.200000000000001],["F4",.5999999999999996],["E4",.5999999999999996],["G3",1.1999999999999993],["E4",.5999999999999996],["D4",1.1999999999999993],["G3",1.1999999999999993],["G4",.6000000000000014],["E3",1.200000000000001],["G4",.5999999999999996],["F4",.5999999999999996],["F3",1.200000000000001],["F4",.6000000000000014],["E4",.5999999999999979],["G3",1.1999999999999993],["E4",.6000000000000014],["D4",1.1999999999999993],["G3",1.1999999999999993],["C4",.6000000000000014],["C3",1.1999999999999993],["C4",.5999999999999979],["G4",.6000000000000014],["E3",1.1999999999999993],["G4",.5999999999999979],["A4",.6000000000000014],["F3",1.2000000000000028],["A4",.6000000000000014],["G4",1.1999999999999993],["E3",1.1999999999999993],["F4",.5999999999999979],["D3",1.1999999999999993],["F4",.6000000000000014],["E4",.6000000000000014],["C3",1.1999999999999993],["E4",.5999999999999979],["D4",.6000000000000014],["F3",.6000000000000014],["D4",.5999999999999979],["G3",.5999999999999979],["C4",1.1999999999999993],["C3",1.1999999999999993]],k=["at-orbit","at-toybox","paired"];AFRAME.registerComponent("toy",{schema:{key:{type:"string"}},init(){this.soundSystem=this.el.sceneEl.systems.sound,this.elToybox=null,this.orbitPosition=new THREE.Vector3},play(){k.forEach(a=>this.el.addEventListener(a,this))},pause(){k.forEach(a=>this.el.removeEventListener(a,this))},handleEvent(a){const{detail:b}=a;switch(a.type){case"paired":return this.moveToToybox(b.elToybox);case"at-toybox":return this.canPutToyInBox()?this.onMatchSucceed():this.onMatchFailed();case"at-orbit":return this.resumeOrbit();default:}return!1},moveToToybox(a){const b=this.el.getAttribute("position"),c=a.getAttribute("position");this.elToybox=a,this.orbitPosition.copy(b),this.moveTo({position:c,scale:{x:.25,y:.25,z:.25},eventName:"at-toybox"}),this.soundSystem.playEffect(h.MOVE_TO_TOYBOX)},moveToOrbit(){this.moveTo({position:this.orbitPosition,scale:{x:1,y:1,z:1},eventName:"at-orbit"}),this.soundSystem.playEffect(h.MOVE_TO_ORBIT)},resumeOrbit(){this.el.setAttribute("orbit","active",!0)},moveTo({position:a,scale:b,eventName:c}){this.el.setAttribute("orbit","active",!1),this.el.setAttribute("float-to",{targetPosition:a,targetScale:b,active:!0,eventName:c})},canPutToyInBox(){const{elToybox:a}=this,b=a.getAttribute("toybox").key;return b===this.data.key},onMatchSucceed(){const{elToybox:a}=this;a.emit("put-away",{toy:this.el})},onMatchFailed(){this.moveToOrbit()}});const l=["selected","unselected","put-away"];AFRAME.registerComponent("toybox",{schema:{key:{type:"string"},totalToys:{type:"int"},isFull:{default:!1}},init(){this.system=this.el.sceneEl.systems.game,this.elPlanes=this.el.querySelectorAll("a-plane"),this.putAwayCount=0},play(){l.forEach(a=>this.el.addEventListener(a,this))},pause(){l.forEach(a=>this.el.removeEventListener(a,this))},handleEvent(a){const{elPlanes:b}=this;switch(a.type){case"selected":return b.forEach(a=>{a.setAttribute("material","color","#0074D9")}),!0;case"unselected":return b.forEach(a=>{a.setAttribute("material","color","#DDDDDD")}),!0;case"put-away":return this.putAway(a.detail.toy);default:}return!1},putAway(){this.putAwayCount+=1;const a=this.data.totalToys-this.putAwayCount;0==a&&(this.el.setAttribute("toybox","isFull",!0),this.system.toyboxFilled(this.el))}}),AFRAME.registerComponent("timer",{schema:{active:{default:!0},isPlaying:{default:!1}},init:function(){this.system=this.el.sceneEl.systems.game,this.soundSystem=this.el.sceneEl.systems.sound,this.milliseconds=0},tick(b,c){if(this.data.active&&this.data.isPlaying){const b=0|this.milliseconds/1e3;this.milliseconds+=c;const d=0|this.milliseconds/1e3;b==d||(this.el.setAttribute("text",{value:`${a(this.milliseconds)}`}),this.soundSystem.playEffect(h.TIMER_TICK))}}});let m=0;class n{constructor(a){var c=Math.PI;this.scene=document.querySelector("a-scene"),this.el=document.createElement("a-entity"),this.el.id=b(),this.el.setAttribute("position",`0 ${THREE.Math.randInt(2,4)} 0`),this.el.setAttribute("rotation","0 0 0"),this.el.setAttribute("float-to",{speed:.05}),this.el.setAttribute("toy",{key:a}),this.el.setAttribute("orbit",{radius:THREE.Math.randInt(3,6),startTheta:THREE.Math.randFloat(0,2*c),deltaTheta:(0===THREE.Math.randInt(0,1)?1:-1)*(2*c/Math.pow(10,THREE.Math.randFloat(3,4)))}),this.el.innerHTML=`<a-entity
      selectable
      geometry="primitive: extrudeShape; icon: ${a}"
      material="opacity: 1; shader: standard"
      >
    </a-entity>`,this.scene.appendChild(this.el)}}const o=.25,p=.5,q=.5;class r{constructor(a){const{position:c,shape:d,totalToys:e}=a;this.scene=document.querySelector("a-scene"),this.el=document.createElement("a-entity"),this.el.id=b(),this.el.setAttribute("position",c),this.el.setAttribute("toybox",{key:d,totalToys:e}),this.el.innerHTML=`
      <a-plane position="0 ${o/2} ${q/2}" rotation="0 0 0" height="${o}" width="${p}" material="side: double"></a-plane>
      <a-plane position="0 ${o/2} ${-q/2}" rotation="0 0 0" height="${o}" width="${p}" material="side: double"></a-plane>
      <a-plane position="${p/2} ${o/2} 0" rotation="0 90 0" height="${o}" width="${p}" material="side: double"></a-plane>
      <a-plane position="${-p/2} ${o/2} 0" rotation="0 90 0"   height="${o}" width="${p}" material="side: double"></a-plane>
      <a-plane position="0 0 0" rotation="-90 0 0" height="${q}" width="${p}"></a-plane>
      <!-- Collision Box -->
      <a-entity selectable="type: Toybox" geometry="primitive: box; width: 1; height: 1; depth: 1" material="visible: false"></a-entity>
      <!-- Sign for the user -->
      <a-entity position="-${p/3} 0 ${q/2}" scale="0.25 0.25 0.25" geometry="primitive: extrudeShape; icon: ${d}"></a-entity>
    `,this.scene.appendChild(this.el)}}const s=Object.keys(g).filter(a=>!f.includes(a)),t=(a=s)=>a[THREE.Math.randInt(0,a.length-1)],u=3,v=4;AFRAME.registerSystem("game",{init(){this.state=Object.assign({},c(),{selectedToy:null,selectedToybox:null}),this.elTimer=document.querySelector("[timer]")},setSelected(a){const b=a.getAttribute("selectable").type,c=`selected${b}`,d=this.state[c];a!==d&&(this.state[c]&&this.state[c].setAttribute("selectable","isSelected",!1),this.state[c]=a,this.state.selectedToy&&this.state.selectedToybox&&(this.state.selectedToy.emit("paired",{elToybox:this.state.selectedToybox.closest("[toybox]")}),this.state.selectedToy.setAttribute("selectable","isSelected",!1),this.state.selectedToy=null))},toyboxFilled(a){const b=this.state.toyboxes.every(a=>a.el.getAttribute("toybox").isFull);console.log("isGameover",b)}});const w={C0:16.35,"C#0":17.32,Db0:17.32,D0:18.35,"D#0":19.45,Eb0:19.45,E0:20.6,F0:21.83,"F#0":23.12,Gb0:23.12,G0:24.5,"G#0":25.96,Ab0:25.96,A0:27.5,"A#0":29.14,Bb0:29.14,B0:30.87,C1:32.7,"C#1":34.65,Db1:34.65,D1:36.71,"D#1":38.89,Eb1:38.89,E1:41.2,F1:43.65,"F#1":46.25,Gb1:46.25,G1:49,"G#1":51.91,Ab1:51.91,A1:55,"A#1":58.27,Bb1:58.27,B1:61.74,C2:65.41,"C#2":69.3,Db2:69.3,D2:73.42,"D#2":77.78,Eb2:77.78,E2:82.41,F2:87.31,"F#2":92.5,Gb2:92.5,G2:98,"G#2":103.83,Ab2:103.83,A2:110,"A#2":116.54,Bb2:116.54,B2:123.47,C3:130.81,"C#3":138.59,Db3:138.59,D3:146.83,"D#3":155.56,Eb3:155.56,E3:164.81,F3:174.61,"F#3":185,Gb3:185,G3:196,"G#3":207.65,Ab3:207.65,A3:220,"A#3":233.08,Bb3:233.08,B3:246.94,C4:261.63,"C#4":277.18,Db4:277.18,D4:293.66,"D#4":311.13,Eb4:311.13,E4:329.63,F4:349.23,"F#4":369.99,Gb4:369.99,G4:392,"G#4":415.3,Ab4:415.3,A4:440,"A#4":466.16,Bb4:466.16,B4:493.88,C5:523.25,"C#5":554.37,Db5:554.37,D5:587.33,"D#5":622.25,Eb5:622.25,E5:659.26,F5:698.46,"F#5":739.99,Gb5:739.99,G5:783.99,"G#5":830.61,Ab5:830.61,A5:880,"A#5":932.33,Bb5:932.33,B5:987.77,C6:1046.5,"C#6":1108.73,Db6:1108.73,D6:1174.66,"D#6":1244.51,Eb6:1244.51,E6:1318.51,F6:1396.91,"F#6":1479.98,Gb6:1479.98,G6:1567.98,"G#6":1661.22,Ab6:1661.22,A6:1760,"A#6":1864.66,Bb6:1864.66,B6:1975.53,C7:2093,"C#7":2217.46,Db7:2217.46,D7:2349.32,"D#7":2489.02,Eb7:2489.02,E7:2637.02,F7:2793.83,"F#7":2959.96,Gb7:2959.96,G7:3135.96,"G#7":3322.44,Ab7:3322.44,A7:3520,"A#7":3729.31,Bb7:3729.31,B7:3951.07,C8:4186.01,"C#8":4435,D8:4699,Eb8:4978,E8:5274,F8:5588,"F#8":5920,G8:6272,"G#8":6645,A8:7040,Bb8:7040,B8:7902};class x{constructor(a,b,c="sine"){this.context=a,this.oscillator=a.createOscillator(),this.oscillator.frequency.value=b,this.oscillator.type=c,this.gain=a.createGain(),this.gain.gain.value=0,this.oscillator.connect(this.gain),this.gain.connect(a.destination),this.oscillator.start(0)}play(a){const b=.001,{gain:c}=this.gain,{currentTime:d}=this.context;c.cancelScheduledValues(d),c.setValueAtTime(0,d),c.exponentialRampToValueAtTime(1,d+b),c.exponentialRampToValueAtTime(1e-4,d+b+.001+a)}dispose(){this.oscillator.stop(0),this.oscillator.disconnect(),this.gain.disconnect()}}AFRAME.registerSystem("sound",{schema:{},init(){this.audioContext=null,this.queuedNotes=[],this.voices={},document.monetization&&"started"===document.monetization.state?this.playEffect(j,!0):this.playEffect(i,!0),this.sceneEl.addEventListener("enter-vr",this),this.sceneEl.addEventListener("exit-vr",this),window.addEventListener("click",this)},tick(){if(!this.audioContext)return;const{queuedNotes:a}=this,{currentTime:b}=this.audioContext,c=a.filter(a=>{const c=b-a.startTime;return c>a.duration});c.forEach(a=>{const{noteName:b,duration:c}=a,d=this.getVoice(b);d.play(c)}),c.forEach(c=>{const{done:d,value:e}=c.noteIter.next();if(d){const b=a.indexOf(c);return void this.queuedNotes.splice(b,1)}const[f,g]=e;c.startTime=b,c.duration=g,c.noteName=f})},handleEvent(a){switch(a.type){case"click":case"enter-vr":window.removeEventListener("click",this),this.createAudioContext();break;case"exit-vr":this.dispose();break;default:}},playEffect(a,b=!1){const c=e(a,b),{value:[d,f]}=c.next();this.queuedNotes.push({startTime:-1,duration:f,noteName:d,noteIter:c})},createAudioContext(){this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext))},dispose(){this.audioContext&&(this.audioContext.close(),this.audioContext=null)},getVoice(a){const{audioContext:b}=this;let c=this.voices[a];return c||(c=new x(b,d(a)),this.voices[a]=c),c}})})();</script><body><a-scene><a-entity id=player position="-0.20 0 0.5"><a-entity id=camera position="0 1.6 0" camera look-controls wasd-controls></a-entity><a-entity id=mouseHand raycaster="objects: [selectable]" cursor="rayOrigin: mouse"></a-entity><a-entity id=controllerHand raycaster="objects: [selectable]" laser-controls="model: false" line="color: #FF4136; opacity: 0.75;"></a-entity></a-entity><a-sky color=#7FDBFF></a-sky><a-plane color=#3D9970 height=100 rotation="-90 0 0" width=100></a-plane><a-entity rotation="0 -60 180"><a-entity position="0.1 -0.43 0.25" rotation="45 -90 180" text="value: 00:00; color: #000; align: center; width: 4;" timer></a-entity><a-entity geometry="primitive: extrudeShape; icon: TIMER; extrudeDepth: 1;" material="color: #AAAAAA;" scale="0.5 0.5 0.5"></a-entity></a-entity></a-scene>